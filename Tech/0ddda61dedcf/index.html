<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">

<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/heart.svg" color="#222">
  <meta name="google-site-verification" content="G1zxL8_uEau107sKvFuMkecN7hNlJeQdhTqIaBuwQOI">
  <meta name="msvalidate.01" content="G1zxL8_uEau107sKvFuMkecN7hNlJeQdhTqIaBuwQOI">
  <meta name="baidu-site-verification" content="thkJPSuv5DFAoiiq">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic%7Cserif:300,300italic,400,400italic,700,700italic%7CHanziPenSC-W5:300,300italic,400,400italic,700,700italic%7CCinzel+Decorative:300,300italic,400,400italic,700,700italic%7CAmstelvar:300,300italic,400,400italic,700,700italic%7Cglyph-correction:300,300italic,400,400italic,700,700italic%7CSource+Code+Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css" integrity="sha256-no0c5ccDODBwp+9hSmV5VvPpKwHCpbVzXHexIkupM6U=" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js" integrity="sha256-a5YRB27CcBwBFcT5EF/f3E4vzIqyHrSR878nseNYw64=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;alessa0.cn&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Pisces&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:true,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:&quot;gitalk&quot;,&quot;storage&quot;:true,&quot;lazyload&quot;:true,&quot;nav&quot;:null,&quot;activeClass&quot;:&quot;gitalk&quot;},&quot;motion&quot;:{&quot;enable&quot;:false,&quot;async&quot;:true,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;},&quot;path&quot;:&quot;&#x2F;search.xml&quot;,&quot;localsearch&quot;:{&quot;enable&quot;:true,&quot;trigger&quot;:&quot;auto&quot;,&quot;top_n_per_article&quot;:5,&quot;unescape&quot;:false,&quot;preload&quot;:true}}</script><script src="/js/config.js"></script>
<meta name="description" content="推荐系统   kari-shea-Pe97ltx47Lw-unsplash">
<meta property="og:type" content="article">
<meta property="og:title" content="BigData 复习笔记 03：推荐算法">
<meta property="og:url" content="https://alessa0.cn/Tech/0ddda61dedcf/">
<meta property="og:site_name" content="听泉.ღ">
<meta property="og:description" content="推荐系统   kari-shea-Pe97ltx47Lw-unsplash">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://image.alessa0.cn/120137.jpg">
<meta property="article:published_time" content="2019-07-30T11:51:35.000Z">
<meta property="article:modified_time" content="2021-06-18T07:35:21.112Z">
<meta property="article:author" content="XIE QING">
<meta property="article:tag" content="BigData">
<meta property="article:tag" content="推荐">
<meta property="article:tag" content="Content-Based">
<meta property="article:tag" content="协同">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://image.alessa0.cn/120137.jpg">


<link rel="canonical" href="https://alessa0.cn/Tech/0ddda61dedcf/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;https:&#x2F;&#x2F;alessa0.cn&#x2F;Tech&#x2F;0ddda61dedcf&#x2F;&quot;,&quot;path&quot;:&quot;Tech&#x2F;0ddda61dedcf&#x2F;&quot;,&quot;title&quot;:&quot;BigData 复习笔记 03：推荐算法&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>BigData 复习笔记 03：推荐算法 | 听泉.ღ</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125031312-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{&quot;tracking_id&quot;:&quot;UA-125031312-1&quot;,&quot;only_pageview&quot;:false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?e3a5e194c5c7cb7bbd97a2d5f0f44f33"></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">听泉.ღ</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">— 听泉小窝 —</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tech"><a href="/categories/Tech/" rel="section"><i class="fas fa-terminal fa-fw"></i>技术</a></li>
        <li class="menu-item menu-item-life"><a href="/categories/Life/" rel="section"><i class="fas fa-bed fa-fw"></i>生活</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.</span> <span class="nav-text">推荐系统</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%8E%A8%E8%8D%90%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.</span> <span class="nav-text">常用推荐算法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E4%BA%BA%E5%8F%A3%E7%9A%84%E6%8E%A8%E8%8D%90"><span class="nav-number">1.1.1.</span> <span class="nav-text">基于人口的推荐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%86%85%E5%AE%B9%E7%9A%84%E6%8E%A8%E8%8D%90"><span class="nav-number">1.1.2.</span> <span class="nav-text">基于内容的推荐</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E5%85%A5item%E5%B1%9E%E6%80%A7%E7%9A%84cb%E6%8E%A8%E8%8D%90"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">引入 Item 属性的 CB 推荐</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E5%85%A5user%E5%B1%9E%E6%80%A7%E7%9A%84cb%E6%8E%A8%E8%8D%90"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">引入 User 属性的 CB 推荐</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#demo%E5%80%92%E6%8E%92%E8%A1%A8"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">【Demo】倒排表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%8D%8F%E5%90%8C%E7%9A%84%E6%8E%A8%E8%8D%90"><span class="nav-number">1.1.3.</span> <span class="nav-text">基于协同的推荐</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#user-based-cf"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">User-Based CF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#item-based-cf"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">Item-Based CF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%8F%E5%90%8C%E6%8E%A8%E8%8D%90%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%E4%BB%A5item-based%E4%B8%BA%E4%BE%8B"><span class="nav-number">1.1.3.3.</span> <span class="nav-text">协同推荐实现方案（以 Item-Based 为例）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%80%92%E6%8E%92%E5%BC%8F"><span class="nav-number">1.1.3.3.1.</span> <span class="nav-text">倒排式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%B7%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98"><span class="nav-number">1.1.4.</span> <span class="nav-text">冷启动问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E5%86%B7%E5%90%AF%E5%8A%A8"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">用户冷启动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%A9%E5%93%81%E5%86%B7%E5%90%AF%E5%8A%A8"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">物品冷启动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E5%86%B7%E5%90%AF%E5%8A%A8"><span class="nav-number">1.1.4.3.</span> <span class="nav-text">系统冷启动</span></a></li></ol></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="XIE QING"
      src="/images/logo.png">
  <p class="site-author-name" itemprop="name">XIE QING</p>
  <div class="site-description" itemprop="description">怜我世人, 焚我残躯。</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/xieqing0428" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xieqing0428" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/xieqing001" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;xieqing001" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.douban.com/people/xieqing0428" title="Douban → https:&#x2F;&#x2F;www.douban.com&#x2F;people&#x2F;xieqing0428" rel="noopener" target="_blank"><i class="fab fa-imdb fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:xieqing0428@gmail.com" title="E-Mail → mailto:xieqing0428@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>



          </div>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alessa0.cn/Tech/0ddda61dedcf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="XIE QING">
      <meta itemprop="description" content="怜我世人, 焚我残躯。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="听泉.ღ">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          BigData 复习笔记 03：推荐算法
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-30 19:51:35" itemprop="dateCreated datePublished" datetime="2019-07-30T19:51:35+08:00">2019-07-30</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-18 15:35:21" itemprop="dateModified" datetime="2021-06-18T15:35:21+08:00">2021-06-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>8 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p class="description">
推荐系统
</p>
<figure>
<img src="https://image.alessa0.cn/120137.jpg" alt="kari-shea-Pe97ltx47Lw-unsplash"><figcaption aria-hidden="true">kari-shea-Pe97ltx47Lw-unsplash</figcaption>
</figure>
<span id="more"></span>
<blockquote class="blockquote-center">
<p>Chapter03. 推荐算法</p>

</blockquote>
<h1 id="推荐系统">推荐系统</h1>
<blockquote>
<p>个性化推荐系统，基于海量数据向用户建议商品</p>
</blockquote>
<p>基于数据，利用算法，对用户和商品深度挖掘</p>
<h2 id="常用推荐算法">常用推荐算法</h2>
<h3 id="基于人口的推荐">基于人口的推荐</h3>
<blockquote>
<p>最容易实现</p>
</blockquote>
<p>根据用户基本信息发现用户之间的相关程度，将相似用户喜欢的商品推荐给当前用户。</p>
<p>基本信息包括：<strong>（不包含用户行为信息）</strong></p>
<ul>
<li>性别</li>
<li>年龄</li>
<li>地域</li>
<li>……</li>
</ul>
<h3 id="基于内容的推荐">基于内容的推荐</h3>
<blockquote>
<p>Content Based，初期最为广泛使用</p>
</blockquote>
<p>根据商品的元信息，利用内容相关性，基于用户以往的喜好，给用户推荐相似的商品</p>
<h4 id="引入item属性的cb推荐">引入 Item 属性的 CB 推荐</h4>
<p>对当前 Item 进行内容分析，利用属性索引，在数据库中进行相关性计算，取出相关 Item 推荐给 User</p>
<ul>
<li>优点
<ul>
<li>提升推荐结果相关性</li>
<li>结果可解释</li>
<li>推荐结果易被用户感知</li>
</ul></li>
<li>缺点
<ul>
<li>无个性化</li>
<li>依赖对 Item 的深度分析</li>
</ul></li>
</ul>
<h4 id="引入user属性的cb推荐">引入 User 属性的 CB 推荐</h4>
<p>对当前 Item 进行内容分析，利用属性索引，结合 User 行为数据，在数据库中进行相关性计算，取出相关 Item 推荐给 User</p>
<ul>
<li>优点
<ul>
<li>用户模型刻画了用户兴趣需求</li>
<li>推荐形式多样，具有个性化</li>
<li>结果可解释</li>
</ul></li>
<li>缺点
<ul>
<li>推荐精度低</li>
<li>马太效应
<ul>
<li>解决：试探，加入随机推荐位</li>
</ul></li>
<li>用户行为稀疏导致覆盖率低</li>
</ul></li>
</ul>
<p>不同场景选取不同推荐方式</p>
<h4 id="demo倒排表">【Demo】倒排表</h4>
<blockquote>
<p>对 Item 进行挖掘，得出 Token -&gt; ItemA:ScoreA, ItemB:ScoreB, … 倒排表</p>
</blockquote>
<ol type="1">
<li><p>对 Item 中文分词，得出正排表</p>
<figure class="highlight python"><figcaption><span>fenci.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">os.system(<span class="string">'tar xvzf jieba.tar.gz &gt; /dev/null'</span>)</span><br><span class="line">sys.path.append(<span class="string">"./"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"><span class="keyword">import</span> jieba.posseg</span><br><span class="line"><span class="keyword">import</span> jieba.analyse</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ss = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ss) != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    music_id, music_name = ss</span><br><span class="line">    tmp_list = []</span><br><span class="line">    <span class="keyword">for</span> x, w <span class="keyword">in</span> jieba.analyse.extract_tags(music_name, withWeight=<span class="literal">True</span>):</span><br><span class="line">        tmp_list.append((x, <span class="built_in">float</span>(w)))</span><br><span class="line">    final_list = <span class="built_in">sorted</span>(tmp_list, key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'\t'</span>.join([music_id, music_name, <span class="string">','</span>.join([<span class="string">':'</span>.join([t_w[<span class="number">0</span>], <span class="built_in">str</span>(t_w[<span class="number">1</span>])]) <span class="keyword">for</span> t_w <span class="keyword">in</span> final_list])]))</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>转置</p>
<figure class="highlight python"><figcaption><span>map_inverted.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ss = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ss) != <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    music_id = ss[<span class="number">0</span>].strip()</span><br><span class="line">    music_name = ss[<span class="number">1</span>].strip()</span><br><span class="line">    music_token_list = ss[<span class="number">2</span>].strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> feature <span class="keyword">in</span> music_token_list.split(<span class="string">','</span>):</span><br><span class="line">        ss = feature.strip().split(<span class="string">':'</span>)</span><br><span class="line">        token = ss[<span class="number">0</span>].strip()</span><br><span class="line">        weight = ss[<span class="number">1</span>].strip()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'\t'</span>.join([token, music_name, weight]))</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>得到倒排表</p>
<figure class="highlight python"><figcaption><span>red_inverted.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">cur_token = <span class="literal">None</span></span><br><span class="line">m_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ss = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ss) != <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    token = ss[<span class="number">0</span>].strip()</span><br><span class="line">    name = ss[<span class="number">1</span>].strip()</span><br><span class="line">    weight = <span class="built_in">float</span>(ss[<span class="number">2</span>].strip())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cur_token <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        cur_token = token</span><br><span class="line">    <span class="keyword">if</span> cur_token != token:</span><br><span class="line">        final_list = <span class="built_in">sorted</span>(m_list, key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'\t'</span>.join([cur_token, <span class="string">','</span>.join([<span class="string">':'</span>.join([name_weight[<span class="number">0</span>], <span class="built_in">str</span>(name_weight[<span class="number">1</span>])]) <span class="keyword">for</span> name_weight <span class="keyword">in</span> final_list])]))</span><br><span class="line">        cur_token = token</span><br><span class="line">        m_list = []</span><br><span class="line"></span><br><span class="line">    m_list.append((name, weight))</span><br><span class="line"></span><br><span class="line">final_list = <span class="built_in">sorted</span>(m_list, key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'\t'</span>.join([cur_token.strip(), <span class="string">','</span>.join([<span class="string">':'</span>.join([name_weight[<span class="number">0</span>], <span class="built_in">str</span>(name_weight[<span class="number">1</span>])]) <span class="keyword">for</span> name_weight <span class="keyword">in</span> final_list])]))</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>【Hadoop Streaming 脚本】</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line">HADOOP_CMD=<span class="string">"/usr/local/src/hadoop-2.8.5/bin/hadoop"</span></span><br><span class="line">STREAM_JAR_PATH=<span class="string">"/usr/local/src/hadoop-2.8.5/share/hadoop/tools/lib/hadoop-streaming-2.8.5.jar"</span></span><br><span class="line"></span><br><span class="line">INPUT_FILE_PATH=<span class="string">"/chapter03/01_inverted/music_meta.txt.small"</span></span><br><span class="line">OUTPUT_PATH_FENCI=<span class="string">"/chapter03/01_inverted/output/python3/fenci"</span></span><br><span class="line">OUTPUT_PATH=<span class="string">"/chapter03/01_inverted/output/python3/result"</span></span><br><span class="line">LOCAL_FILE_PATH=<span class="string">"/mnt/hgfs/Code/chapter03/01_inverted/music_meta.txt.small"</span></span><br><span class="line">UPLOAD_PATH=<span class="string">"/chapter03/01_inverted"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> fs -rm -r -skipTrash <span class="variable">${INPUT_FILE_PATH}</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> fs -rm -r -skipTrash <span class="variable">${OUTPUT_PATH}</span> <span class="variable">${OUTPUT_PATH_FENCI}</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> fs -mkdir -p <span class="variable">${UPLOAD_PATH}</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> fs -put <span class="variable">${LOCAL_FILE_PATH}</span> <span class="variable">${UPLOAD_PATH}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1.</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> jar <span class="variable">${STREAM_JAR_PATH}</span> \</span><br><span class="line">    -D mapreduce.job.reduces=0 \</span><br><span class="line">    -D mapreduce.map.memory.mb=4096 \</span><br><span class="line">    -D mapreduce.job.name=jieba_fenci_demo \</span><br><span class="line">    -files map.py,jieba.tar.gz \</span><br><span class="line">    -input <span class="variable">${INPUT_FILE_PATH}</span> \</span><br><span class="line">    -output <span class="variable">${OUTPUT_PATH_FENCI}</span> \</span><br><span class="line">    -mapper <span class="string">"python map.py"</span> \</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2.</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> jar <span class="variable">${STREAM_JAR_PATH}</span> \</span><br><span class="line">    -D mapreduce.job.reduces=2 \</span><br><span class="line">    -D mapreduce.job.name=demo_inverted \</span><br><span class="line">    -files map_inverted.py,red_inverted.py \</span><br><span class="line">    -input <span class="variable">${OUTPUT_PATH_FENCI}</span> \</span><br><span class="line">    -output <span class="variable">${OUTPUT_PATH}</span> \</span><br><span class="line">    -mapper <span class="string">"python map_inverted.py"</span> \</span><br><span class="line">    -reducer <span class="string">"python red_inverted.py"</span> \</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h3 id="基于协同的推荐">基于协同的推荐</h3>
<p>从 User 行为日志中挖掘，User 与 Item 关联构成 UI 矩阵 or IU 矩阵</p>
<p>可使用 UI * IU 得到 UU 矩阵，使用 IU * UI 得到 II 矩阵</p>
<ul>
<li>优点
<ul>
<li>充分利用群体智慧</li>
<li>推荐精度高于 CB</li>
<li> 利于挖掘隐含的相关性</li>
</ul></li>
<li>缺点
<ul>
<li>推荐结果解释性较差</li>
<li>对时效性强的 Item 不适用</li>
<li>冷启动问题</li>
</ul></li>
</ul>
<h4 id="user-based-cf">User-Based CF</h4>
<blockquote>
<p>假设：</p>
<p>用户喜欢那些跟他有相似爱好的用户喜欢的东西</p>
<p>具有相似兴趣的用户在未来也具有相似兴趣</p>
</blockquote>
<h4 id="item-based-cf">Item-Based CF</h4>
<blockquote>
<p>假设：</p>
<p>用户喜欢跟他过去喜欢的物品相似的物品</p>
<p>历史上相似的物品未来也相似</p>
</blockquote>
<table>
<colgroup>
<col style="width: 16%">
<col style="width: 41%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>User-Based</th>
<th>Item-Based</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td> 性能</td>
<td>适用于用户较少场合，如果用户多，计算 UU 矩阵代价太大</td>
<td>适用于物品数明显小于用户数的场合，物品多。计算 II 矩阵代价太大</td>
</tr>
<tr class="even">
<td>领域</td>
<td>时效性强，用户个性化兴趣不太明显的领域</td>
<td>长尾物品丰富，用户个性化需求强烈的领域</td>
</tr>
<tr class="odd">
<td>实时性</td>
<td>用户有新行为，不一定造成推荐结果立即变化</td>
<td>用户有新行为，一定导致推荐结果实时变化</td>
</tr>
<tr class="even">
<td>冷启动</td>
<td>在新用户对很少物品产生行为后，不能立即进行个性化推荐，UU 矩阵需要更新。新物品上线后，一旦有用户对物品产生行为，就可以将新物品推荐给兴趣相似的其他用户</td>
<td>新用户只要对一个物品产生行为，就可以给他推荐和该物品相关的其他物品。在没有更新 II 矩阵的情况下无法将新物品推荐给用户</td>
</tr>
<tr class="odd">
<td>推荐理由</td>
<td>很难提供令用户信服的推荐解释</td>
<td>利用用户历史行为给用户做推荐解释，可以令用户比较信服</td>
</tr>
</tbody>
</table>
<h4 id="协同推荐实现方案以item-based为例">协同推荐实现方案（以 Item-Based 为例）</h4>
<h5 id="倒排式">倒排式</h5>
<ol start="0" type="1">
<li><p>相似度计算公式</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -4.118ex" xmlns="http://www.w3.org/2000/svg" width="32.371ex" height="7.722ex" role="img" focusable="false" viewBox="0 -1592.9 14308 3412.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(444,0)"></path><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(944,0)"></path></g><g data-mml-node="mo" transform="translate(1338,0)"><path data-c="2061" d=""></path></g><g data-mml-node="mo" transform="translate(1338,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1727,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"></path></g><g data-mml-node="mo" transform="translate(2196,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2862.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(3918.6,0)"><g data-mml-node="mrow" transform="translate(2528.9,803.3)"><g data-mml-node="munderover"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1299,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="msub" transform="translate(2577.8,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g data-mml-node="msub" transform="translate(3954.7,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g></g><g data-mml-node="mrow" transform="translate(220,-1228.1)"><g data-mml-node="msqrt"><g transform="translate(1020,0)"><g data-mml-node="munderover"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1299,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="msubsup" transform="translate(2577.8,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="TeXAtom" transform="translate(605,353.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(605,-317.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(0,58.1)"><path data-c="221A" d="M1001 1150Q1017 1150 1020 1132Q1020 1127 741 244L460 -643Q453 -650 436 -650H424Q423 -647 423 -645T421 -640T419 -631T415 -617T408 -594T399 -560T385 -512T367 -448T343 -364T312 -259L203 119L138 41L111 67L212 188L264 248L472 -474L983 1140Q988 1150 1001 1150Z"></path></g><rect width="3954.7" height="60" x="1020" y="1148.1"></rect></g><g data-mml-node="msqrt" transform="translate(4974.7,0)"><g transform="translate(1020,0)"><g data-mml-node="munderover"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1299,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="msubsup" transform="translate(2577.8,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="TeXAtom" transform="translate(605,353.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(605,-317.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(0,58.1)"><path data-c="221A" d="M1001 1150Q1017 1150 1020 1132Q1020 1127 741 244L460 -643Q453 -650 436 -650H424Q423 -647 423 -645T421 -640T419 -631T415 -617T408 -594T399 -560T385 -512T367 -448T343 -364T312 -259L203 119L138 41L111 67L212 188L264 248L472 -474L983 1140Q988 1150 1001 1150Z"></path></g><rect width="3954.7" height="60" x="1020" y="1148.1"></rect></g></g><rect width="10149.4" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></span></p></li>
<li><p>处理数据</p>
<p>格式 {user, item, score}</p></li>
<li><p> 构建 II 矩阵</p>
<ol type="1">
<li><p>归一化矩阵</p>
<ol type="1">
<li><p>转置 UI 矩阵 -&gt; IU 矩阵</p>
<figure class="highlight python"><figcaption><span>1_gen_ui_map.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ss = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ss) != <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    user, item, score = ss</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (item, user, score))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>归一化</p>
<figure class="highlight python"><figcaption><span>1_gen_ui_red.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">cur_item = <span class="literal">None</span></span><br><span class="line">user_score_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    item, user, score = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> cur_item <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        cur_item = item</span><br><span class="line">    <span class="keyword">if</span> cur_item != item:</span><br><span class="line">        <span class="built_in">sum</span> = <span class="number">0.0</span></span><br><span class="line">        <span class="keyword">for</span> kv <span class="keyword">in</span> user_score_list:</span><br><span class="line">            (u, s) = kv</span><br><span class="line">            <span class="built_in">sum</span> += <span class="built_in">pow</span>(s, <span class="number">2</span>)</span><br><span class="line">        <span class="built_in">sum</span> = math.sqrt(<span class="built_in">sum</span>)</span><br><span class="line">        <span class="keyword">for</span> kv <span class="keyword">in</span> user_score_list:</span><br><span class="line">            (u, s) = kv</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (u, cur_item, <span class="built_in">float</span>(s / <span class="built_in">sum</span>)))</span><br><span class="line">        user_score_list = []</span><br><span class="line">        cur_item = item</span><br><span class="line"></span><br><span class="line">    user_score_list.append((user, <span class="built_in">float</span>(score)))</span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0.0</span></span><br><span class="line"><span class="keyword">for</span> kv <span class="keyword">in</span> user_score_list:</span><br><span class="line">    (u, s) = kv</span><br><span class="line">    <span class="built_in">sum</span> += <span class="built_in">pow</span>(s, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">sum</span> = math.sqrt(<span class="built_in">sum</span>)</span><br><span class="line"><span class="keyword">for</span> kv <span class="keyword">in</span> user_score_list:</span><br><span class="line">    (u, s) = kv</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (u, cur_item, <span class="built_in">float</span>(s / <span class="built_in">sum</span>)))</span><br></pre></td></tr></tbody></table></figure></li>
</ol></li>
<li><p>生成 II-pair 对</p>
<ol type="1">
<li><p>标准输入输出</p>
<figure class="highlight python"><figcaption><span>2_gen_ii_pair_map.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    u, i, s = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"%s\t%s\t%s"</span> % (u, i, s))</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>生成 {item, item, score}</p>
<figure class="highlight python"><figcaption><span>2_gen_ii_pair_red.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">cur_user = <span class="literal">None</span></span><br><span class="line">item_score_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    user, item, score = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> cur_user <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        cur_user = user</span><br><span class="line">    <span class="keyword">if</span> cur_user != user:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(item_score_list) - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(item_score_list)):</span><br><span class="line">                item_a, score_a = item_score_list[i]</span><br><span class="line">                item_b, score_b = item_score_list[j]</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (item_a, item_b, score_a * score_b))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (item_b, item_a, score_a * score_b))</span><br><span class="line">        item_score_list = []</span><br><span class="line">        cur_user = user</span><br><span class="line">    item_score_list.append((item, <span class="built_in">float</span>(score)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(item_score_list) - <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(item_score_list)):</span><br><span class="line">        item_a, score_a = item_score_list[i]</span><br><span class="line">        item_b, score_b = item_score_list[j]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (item_a, item_b, score_a * score_b))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (item_b, item_a, score_a * score_b))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li>
</ol></li>
<li><p>求和</p>
<ol type="1">
<li><p>以 ii 为 key 做 partition</p>
<figure class="highlight python"><figcaption><span>3_sum_map.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    item_a, item_b, score = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"%s\t%s"</span> % (item_a + <span class="string">","</span> + item_b, score))</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>求和</p>
<figure class="highlight python"><figcaption><span>3_sum_red.py</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">cur_ii_pair = <span class="literal">None</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ii_pair, score = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> cur_ii_pair <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        cur_ii_pair = ii_pair</span><br><span class="line">    <span class="keyword">if</span> cur_ii_pair != ii_pair:</span><br><span class="line">        ii = ii_pair.strip().split(<span class="string">','</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(ii) != <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        item_a, item_b = ii</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (item_a, item_b, <span class="built_in">sum</span>))</span><br><span class="line">        cur_ii_pair = ii_pair</span><br><span class="line">        <span class="built_in">sum</span> = <span class="number">0.0</span></span><br><span class="line">    <span class="built_in">sum</span> += <span class="built_in">float</span>(score)</span><br><span class="line">ii = cur_ii_pair.strip().split(<span class="string">','</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(ii) != <span class="number">2</span>:</span><br><span class="line">    sys.exit()</span><br><span class="line">item_a, item_b = ii</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'%s\t%s\t%s'</span> % (item_a, item_b, <span class="built_in">sum</span>))</span><br></pre></td></tr></tbody></table></figure></li>
</ol></li>
<li><p>【Hadoop Streaming 脚本】</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line">HADOOP_CMD=<span class="string">"/usr/local/src/hadoop-2.8.5/bin/hadoop"</span></span><br><span class="line">STREAM_JAR_PATH=<span class="string">"/usr/local/src/hadoop-2.8.5/share/hadoop/tools/lib/hadoop-streaming-2.8.5.jar"</span></span><br><span class="line"></span><br><span class="line">INPUT_FILE_PATH=<span class="string">"/chapter03/02_cf/music_uis.data"</span></span><br><span class="line">OUTPUT_PATH_1=<span class="string">"/chapter03/02_cf/item_based/output/python3/step1"</span></span><br><span class="line">OUTPUT_PATH_2=<span class="string">"/chapter03/02_cf/item_based/output/python3/step2"</span></span><br><span class="line">OUTPUT_PATH_3=<span class="string">"/chapter03/02_cf/item_based/output/python3/step3"</span></span><br><span class="line">LOCAL_FILE_PATH=<span class="string">"/mnt/hgfs/Code/chapter03/02_cf/music_uis.data"</span></span><br><span class="line">UPLOAD_PATH=<span class="string">"/chapter03/02_cf"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> fs -rm -r -skipTrash <span class="variable">${INPUT_FILE_PATH}</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> fs -rm -r -skipTrash <span class="variable">${OUTPUT_PATH_1}</span> <span class="variable">${OUTPUT_PATH_2}</span> <span class="variable">${OUTPUT_PATH_3}</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> fs -mkdir -p <span class="variable">${UPLOAD_PATH}</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> fs -put <span class="variable">${LOCAL_FILE_PATH}</span> <span class="variable">${UPLOAD_PATH}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1.</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> jar <span class="variable">${STREAM_JAR_PATH}</span> \</span><br><span class="line">    -D mapreduce.job.name=step1 \</span><br><span class="line">    -files 1_gen_ui_map.py,1_gen_ui_red.py \</span><br><span class="line">    -input <span class="variable">${INPUT_FILE_PATH}</span> \</span><br><span class="line">    -output <span class="variable">${OUTPUT_PATH_1}</span> \</span><br><span class="line">    -mapper <span class="string">"python 1_gen_ui_map.py"</span> \</span><br><span class="line">    -reducer <span class="string">"python 1_gen_ui_red.py"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2.</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> jar <span class="variable">${STREAM_JAR_PATH}</span> \</span><br><span class="line">    -D mapreduce.job.name=step2 \</span><br><span class="line">    -files 2_gen_ii_pair_map.py,2_gen_ii_pair_red.py \</span><br><span class="line">    -input <span class="variable">${OUTPUT_PATH_1}</span> \</span><br><span class="line">    -output <span class="variable">${OUTPUT_PATH_2}</span> \</span><br><span class="line">    -mapper <span class="string">"python 2_gen_ii_pair_map.py"</span> \</span><br><span class="line">    -reducer <span class="string">"python 2_gen_ii_pair_red.py"</span> \</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 3.</span></span><br><span class="line"><span class="variable">${HADOOP_CMD}</span> jar <span class="variable">${STREAM_JAR_PATH}</span> \</span><br><span class="line">    -D mapreduce.job.name=step3 \</span><br><span class="line">    -files 3_sum_map.py,3_sum_red.py \</span><br><span class="line">    -input <span class="variable">${OUTPUT_PATH_2}</span> \</span><br><span class="line">    -output <span class="variable">${OUTPUT_PATH_3}</span> \</span><br><span class="line">    -mapper <span class="string">"python 3_sum_map.py"</span> \</span><br><span class="line">    -reducer <span class="string">"python 3_sum_red.py"</span> \</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li>
</ol></li>
</ol>
<h3 id="冷启动问题">冷启动问题</h3>
<h4 id="用户冷启动">用户冷启动</h4>
<ol type="1">
<li>提供热门排行榜，等用户数据收集到一定程度再切换到个性化推荐</li>
<li>利用用户注册时提供的年龄、性别等数据做粗粒度的个性化</li>
<li>利用用户社交网络账号，导入用户在社交网站上的好友信息，然后给用户推荐其好友喜欢的物品</li>
<li>在用户新登录时要求其对一些物品进行反馈，收集这些兴趣信息，然后给用户推荐相似的物品</li>
</ol>
<h4 id="物品冷启动">物品冷启动</h4>
<ol type="1">
<li>把新物品推荐给可能对他感兴趣的用户，利用内容信息，将物品推荐给喜欢过和与其相似的物品的用户</li>
<li>物品必须能够在第一时间展现给用户，否则一段时间过后，物品的价值就大大降低了</li>
<li> User-based 和 Item-based 都行不通时，只能利用 Content-Based 解决该问题，频繁更新相关性数据</li>
</ol>
<h4 id="系统冷启动">系统冷启动</h4>
<ul>
<li>引入专家知识，通过一定的高效方式迅速建立起物品的相关性矩阵</li>
</ul>
<p><br></p>
<p><meting-js id="1346104347" server="netease" type="song" preload="none"></meting-js></p>
<hr>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>XIE QING
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://alessa0.cn/Tech/0ddda61dedcf/" title="BigData 复习笔记 03：推荐算法">https://alessa0.cn/Tech/0ddda61dedcf/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/BigData/" rel="tag"><i class="fa fa-tag"></i> BigData</a>
              <a href="/tags/%E6%8E%A8%E8%8D%90/" rel="tag"><i class="fa fa-tag"></i> 推荐</a>
              <a href="/tags/Content-Based/" rel="tag"><i class="fa fa-tag"></i> Content-Based</a>
              <a href="/tags/%E5%8D%8F%E5%90%8C/" rel="tag"><i class="fa fa-tag"></i> 协同</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Tech/998c29cc79e2/" rel="prev" title="BigData 复习笔记 02：TFIDF, LCS 与中文分词">
                  <i class="fa fa-chevron-left"></i> BigData 复习笔记 02：TFIDF, LCS 与中文分词
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">闽ICP备18014770号-1 </a>
      <img src="/images/gongan.png" alt="">
  </div>

<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XIE QING</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">85k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">1:17</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>
<script class="next-config" data-name="chatra" type="application/json">{&quot;enable&quot;:true,&quot;async&quot;:true,&quot;id&quot;:&quot;ziEfeGJkwovPFGxWg&quot;}</script>
<script src="/js/third-party/chat/chatra.js"></script>
<script async src="https://call.chatra.io/chatra.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{&quot;object_url&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;pdfobject@2.2.5&#x2F;pdfobject.min.js&quot;,&quot;integrity&quot;:&quot;sha256-YuNlP9i6s&#x2F;WH7EaU2kErloo9Vc85C3WVqhoMDgsEVpY&#x3D;&quot;},&quot;url&quot;:&quot;&#x2F;lib&#x2F;pdf&#x2F;web&#x2F;viewer&quot;}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{&quot;enable&quot;:true,&quot;theme&quot;:&quot;forest&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mermaid@8.9.3&#x2F;dist&#x2F;mermaid.min.js&quot;,&quot;integrity&quot;:&quot;sha256-OyJHvRcZHaRR6Ig73ppxF4QXk8HzvfgTprRWkulCkfY&#x3D;&quot;}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>

  <script class="next-config" data-name="nprogress" type="application/json">{&quot;enable&quot;:true,&quot;spinner&quot;:true}</script>
  <script src="/js/third-party/nprogress.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{&quot;enable&quot;:true,&quot;tags&quot;:&quot;none&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mathjax@3.1.4&#x2F;es5&#x2F;tex-mml-chtml.js&quot;,&quot;integrity&quot;:&quot;sha256-ncNI9OXOS5Ek4tzVYiOMmN&#x2F;KKCPZ6V0Cpv2P&#x2F;zHntiA&#x3D;&quot;}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{&quot;enable&quot;:true,&quot;github_id&quot;:&quot;xieqing0428&quot;,&quot;repo&quot;:&quot;gitalk&quot;,&quot;client_id&quot;:&quot;ebff00f2118b2ecb19a1&quot;,&quot;client_secret&quot;:&quot;8ec8654b13829e1c459512086f65a6a31e67476e&quot;,&quot;admin_user&quot;:&quot;xieqing0428&quot;,&quot;distraction_free_mode&quot;:true,&quot;proxy&quot;:&quot;https:&#x2F;&#x2F;cors-anywhere.azm.workers.dev&#x2F;https:&#x2F;&#x2F;github.com&#x2F;login&#x2F;oauth&#x2F;access_token&quot;,&quot;language&quot;:&quot;zh-CN&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;gitalk@1.7.2&#x2F;dist&#x2F;gitalk.min.js&quot;,&quot;integrity&quot;:&quot;sha256-Pmj85ojLaPOWwRtlMJwmezB&#x2F;Qg8BzvJp5eTzvXaYAfA&#x3D;&quot;},&quot;path_md5&quot;:&quot;7512f1999e1888922c08cd9eb336e8d4&quot;}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
